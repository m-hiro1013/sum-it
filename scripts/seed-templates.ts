const adminPrompt = require("firebase-admin");
const pathPrompt = require("path");

// ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹
const saPathPrompt = pathPrompt.join(process.cwd(), "sum-it-378f8-firebase-adminsdk-fbsvc-de4b9df2ab.json");
const saJsonPrompt = require(saPathPrompt);

if (!adminPrompt.apps.length) {
    adminPrompt.initializeApp({
        credential: adminPrompt.credential.cert(saJsonPrompt),
    });
}

const dbPrompt = adminPrompt.firestore();

const templates = [
    {
        name: "StructuredPlan (å†ç¾æ€§100%)",
        description: "æƒ…å ±ã®æ§‹é€ åŒ–ã‚’å¾¹åº•ã—ã€Markdownã®è¡¨ã‚„ãƒªã‚¹ãƒˆã‚’é§†ä½¿ã—ãŸè©³ç´°ãªè¨ˆç”»æ›¸ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚",
        type: "end",
        is_active: true,
        content: `æƒ…å ±ã®æ§‹é€ åŒ–ã‚’å¾¹åº•ã™ã‚‹ã€‚Markdownã®è¦‹å‡ºã—ãƒ»è¡¨ãƒ»ãƒªã‚¹ãƒˆãƒ»å¤ªå­—ã‚’ç©æ¥µçš„ã«ä½¿ã„ã€ä¸€ç›®ã§å†…å®¹ãŒç†è§£ã§ãã‚‹è¦–èªæ€§ã®é«˜ã„å½¢å¼ã§å‡ºåŠ›ã™ã‚‹ã€‚èª°ãŒèª­ã‚“ã§ã‚‚è¿·ã‚ãªã„ã€å†ç¾æ€§100%ã®è¨ˆç”»æ›¸ã‚’ä½œæˆã™ã‚‹ã€‚

æ§‹é€ åŒ–ãƒ«ãƒ¼ãƒ« MarkdownPolicy
è¦‹å‡ºã—éšå±¤ HeadingLevel
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåï¼ˆæœ€ä¸Šä½ï¼‰
## Phaseåï¼ˆå¤§åŒºåˆ†ï¼‰
### Taskåï¼ˆä½œæ¥­å˜ä½ï¼‰
#### è£œè¶³é …ç›®ï¼ˆè©³ç´°ï¼‰
è¡¨ã®æ´»ç”¨ TableUsage
æ¯”è¼ƒãƒ»ä¸€è¦§ãƒ»ãƒãƒˆãƒªã‚¯ã‚¹ã¯å¿…ãšè¡¨å½¢å¼
ä¾å­˜é–¢ä¿‚ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ã«æ´»ç”¨
ãƒªã‚¹ãƒˆã®ä½¿ã„åˆ†ã‘ ListPolicy
- ç®‡æ¡æ›¸ã: é †åºé–¢ä¿‚ã®ãªã„åˆ—æŒ™
1. ç•ªå·ä»˜ã: é †åºãƒ»æ‰‹é †ãŒã‚ã‚‹å ´åˆ
  - ãƒã‚¹ãƒˆ: è¦ªå­é–¢ä¿‚ã®è¡¨ç¾ï¼ˆ2éšå±¤ã¾ã§ï¼‰å¼·èª¿ EmphasisRule
å¤ªå­—: é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€å¿…é ˆäº‹é …
ã‚³ãƒ¼ãƒ‰: ãƒ•ã‚¡ã‚¤ãƒ«åã€é–¢æ•°åã€ã‚³ãƒãƒ³ãƒ‰
å¼•ç”¨: æ³¨æ„äº‹é …ã€è­¦å‘Š

è¨ˆç”»å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ PlanTemplate
# [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå]

## æ¦‚è¦ *Overview*
| é …ç›® | å†…å®¹ |
|------|------|
| **ã‚´ãƒ¼ãƒ«** | 1æ–‡ã§å®Œæˆå½¢ã‚’å®šç¾© |
| **å‰ææŠ€è¡“** | ä½¿ç”¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
| **åˆ¶ç´„äº‹é …** | æœŸé™ãƒ»ãƒªã‚½ãƒ¼ã‚¹ãƒ»æŠ€è¡“çš„åˆ¶ç´„ |
| **æƒ³å®šæ™‚é–“** | ç·è¦‹ç©ã‚‚ã‚Šæ™‚é–“ |

## æ©Ÿèƒ½ä¸€è¦§ *Features*
| # | æ©Ÿèƒ½å | æ¦‚è¦ | å„ªå…ˆåº¦ | ä¾å­˜ |
|---|--------|------|--------|------|
| 1 | æ©Ÿèƒ½A | èª¬æ˜ | é«˜ | ãªã— |
| 2 | æ©Ÿèƒ½B | èª¬æ˜ | é«˜ | æ©Ÿèƒ½A |
| 3 | æ©Ÿèƒ½C | èª¬æ˜ | ä¸­ | æ©Ÿèƒ½A,B |

## ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ— *DependencyMap*
æ©Ÿèƒ½A (ä¾å­˜ãªã—) â†“ æ©Ÿèƒ½B (Aã«ä¾å­˜) â†“ æ©Ÿèƒ½C (A,Bã«ä¾å­˜)


## Phase 1: [ãƒ•ã‚§ãƒ¼ã‚ºå] *PhaseBlock*
> **ç›®æ¨™**: ã“ã®ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†æ™‚ã«ä½•ãŒå‹•ãã‹

### Task 1.1: [ã‚¿ã‚¹ã‚¯å] *TaskBlock*
| é …ç›® | å†…å®¹ |
|------|------|
| **ä½œã‚‹ã‚‚ã®** | \`é–¢æ•°å\` / \`ãƒ•ã‚¡ã‚¤ãƒ«å\` |
| **å…¥åŠ›** | å‹ã¾ã§æ˜è¨˜ |
| **å‡ºåŠ›** | å‹ã¾ã§æ˜è¨˜ |
| **å‡¦ç†** | 1-3è¡Œã§èª¬æ˜ |
| **ãƒ†ã‚¹ãƒˆæ¡ä»¶** | ã€Œâ—‹â—‹ã—ãŸã‚‰â–³â–³ã«ãªã‚‹ã€ |
| **æƒ³å®šæ™‚é–“** | â—‹åˆ† |

### Task 1.2: [ã‚¿ã‚¹ã‚¯å]
...

### ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆâ‘  *Checkpoint*
| # | ç¢ºèªé …ç›® | æœŸå¾…çµæœ |
|---|----------|----------|
| 1 | â—‹â—‹ãŒå‹•ä½œã™ã‚‹ | æ­£å¸¸å‹•ä½œ |
| 2 | â–³â–³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | ç”»é¢è¡¨ç¤ºOK |
| 3 | ã‚¨ãƒ©ãƒ¼ãªã— | ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¯ãƒªãƒ¼ãƒ³ |

> **æ¬¡ã«é€²ã‚€æ¡ä»¶**: ä¸Šè¨˜å…¨ã¦OK

## Phase 2: [ãƒ•ã‚§ãƒ¼ã‚ºå]
...

## ãƒªã‚¹ã‚¯ã¨å¯¾ç­– *RiskMatrix*
| # | ãƒªã‚¹ã‚¯ | ç™ºç”Ÿç¢ºç‡ | å½±éŸ¿åº¦ | å¯¾ç­– |
|---|--------|----------|--------|------|
| 1 | â—‹â—‹ãŒç™ºç”Ÿ | ä¸­ | é«˜ | â–³â–³ã§å›é¿ |
| 2 | â–¡â–¡ãŒå¤±æ•— | ä½ | é«˜ | â—‡â—‡ã‚’æº–å‚™ |
| 3 | Ã—Ã—ãŒé…å»¶ | ä¸­ | ä¸­ | ä¸¦åˆ—ä½œæ¥­ã§å¸å |

## å®Œäº†ã®å®šç¾© *DoneDefinition*
- [ ] æ¡ä»¶1: èª¬æ˜
- [ ] æ¡ä»¶2: èª¬æ˜
- [ ] æ¡ä»¶3: èª¬æ˜

> **å…¨ã¦ãƒã‚§ãƒƒã‚¯ãŒå…¥ã£ãŸæ™‚ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†**

ã‚¿ã‚¹ã‚¯è¨˜è¿°ãƒ«ãƒ¼ãƒ« TaskSpec
å¿…é ˆé …ç›®ï¼ˆ1ã‚¿ã‚¹ã‚¯ã«å¿…ãšå«ã‚ã‚‹ï¼‰
é …ç›®	å½¢å¼	ä¾‹
ä½œã‚‹ã‚‚ã®	ã‚³ãƒ¼ãƒ‰å½¢å¼	validateEmail()
å…¥åŠ›	å‹æ˜è¨˜	email: string
å‡ºåŠ›	å‹æ˜è¨˜	boolean
å‡¦ç†	3è¡Œä»¥å†…	æ­£è¦è¡¨ç¾ã§ãƒ¡ãƒ¼ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯
ãƒ†ã‚¹ãƒˆæ¡ä»¶	â—‹â—‹â†’â–³â–³å½¢å¼	"test@example.com" â†’ true
æƒ³å®šæ™‚é–“	åˆ†å˜ä½	15åˆ†

ç¦æ­¢è¡¨ç¾ Forbidden
NG	ç†ç”±	OKä¾‹
ã€œãªã©	æ›–æ˜§	å…·ä½“çš„ã«å…¨ã¦åˆ—æŒ™
é©å®œ	åˆ¤æ–­ä¸¸æŠ•ã’	æ¡ä»¶ã‚’æ˜ç¤º
å¿…è¦ã«å¿œã˜ã¦	åŸºæº–ä¸æ˜	ã€Œâ—‹â—‹ã®å ´åˆã¯â–³â–³ã€
ã„ãã¤ã‹ã®	æ•°ãŒä¸æ˜	ã€Œ3ã¤ã®ã€ã¨æ˜ç¤º

è¦–èªæ€§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ VisibilityCheck
â–¡ è¦‹å‡ºã—éšå±¤ãŒæ­£ã—ã„ï¼ˆ#â†’##â†’###ã®é †åºï¼‰
â–¡ 3é …ç›®ä»¥ä¸Šã®ä¸¦åˆ—æƒ…å ±ã¯è¡¨ã«ãªã£ã¦ã„ã‚‹
â–¡ æ‰‹é †ã¯ç•ªå·ä»˜ããƒªã‚¹ãƒˆã«ãªã£ã¦ã„ã‚‹
â–¡ é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯**å¤ªå­—**ã«ãªã£ã¦ã„ã‚‹
â–¡ ãƒ•ã‚¡ã‚¤ãƒ«åãƒ»é–¢æ•°åã¯\`ã‚³ãƒ¼ãƒ‰å½¢å¼\`ã«ãªã£ã¦ã„ã‚‹
â–¡ æ³¨æ„äº‹é …ã¯ > å¼•ç”¨å½¢å¼ã«ãªã£ã¦ã„ã‚‹
â–¡ ä¸€ç›®ã§æ§‹é€ ãŒæŠŠæ¡ã§ãã‚‹`
    },
    {
        name: "ã‚·ãƒ³ãƒ—ãƒ«ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³",
        description: "æ±ºå®šäº‹é …ã¨ãƒã‚¯ã‚¹ãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç°¡æ½”ã«ã¾ã¨ã‚ã¾ã™ã€‚",
        type: "end",
        is_active: true,
        content: `ã“ã‚Œã¾ã§ã®è­°è«–ã‚’æŒ¯ã‚Šè¿”ã‚Šã€ä»¥ä¸‹ã®å½¢å¼ã§çµè«–ã‚’å‡ºã—ã¦ãã ã•ã„ã€‚
1. æ±ºå®šäº‹é …ã®è¦ç´„
2. å„å‚åŠ è€…ã®ä¸»è¦ãªè¦–ç‚¹
3. ä»Šå¾Œã®å…·ä½“çš„ãªãƒã‚¯ã‚¹ãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³
ç°¡æ½”ã‹ã¤æ˜å¿«ã«ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚`
    },
    {
        name: "ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ä¼šè­°æŒ‡ç¤º",
        description: "ä¸€èˆ¬çš„ãªä¼šè­°é€²è¡Œç”¨ã®å…¨ä½“æŒ‡ç¤ºã§ã™ã€‚",
        type: "start",
        is_active: true,
        content: "ã‚ãªãŸã¯ä¼šè­°ã®è­°é•·ã§ã™ã€‚å‚åŠ è€…ã®æ„è¦‹ã‚’å°Šé‡ã—ã¤ã¤ã€è­°è«–ãŒè­°é¡Œã‹ã‚‰é€¸ã‚Œãªã„ã‚ˆã†ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚å„å‚åŠ è€…ã®ç™ºè¨€ã®æ ¸å¿ƒã‚’çªãã‚ˆã†ãªå•ã„ã‹ã‘ã‚’é©å®œè¡Œã£ã¦ãã ã•ã„ã€‚"
    }
];

async function seedTemplates() {
    console.log("ğŸš€ Starting prompt templates seed...");
    const collectionRef = dbPrompt.collection("prompt_templates");

    for (const template of templates) {
        const docRef = await collectionRef.add({
            ...template,
            created_at: adminPrompt.firestore.FieldValue.serverTimestamp(),
        });
        console.log(`âœ… Seeded Template: ${template.name} (ID: ${docRef.id})`);
    }

    console.log("\nâœ¨ Prompt Templates have been successfully seeded! ğŸ’…ğŸŒˆğŸš€");
    process.exit(0);
}

seedTemplates().catch((error) => {
    console.error("âŒ Seed failed:", error);
    process.exit(1);
});
