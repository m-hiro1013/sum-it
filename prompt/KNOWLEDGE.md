# 🌱 KNOWLEDGE.md

# sum-it 知見蓄積

このプロジェクトで得られた知見や、りなちーが学んだことを記録していくよ！

## 💡 知見（技/Techniques）

### T001: Firebase Firestore と Next.js 14 の連携
- サーバーアクションからもクライアントコンポーネントからもアクセス可能。
- リアルタイム更新には `onSnapshot` が最強。

### T002: LLMモデルのDB管理パターン (Latest 2026)
- モデル名やティアをハードコードせずFirestore管理にすることで、GPT-5.2やClaude-4.5といった最新モデルの追加をデプロイなしで可能にする。

### T003: プロンプト断片のコンポーネント化 (Output Styles)
- 「出力形式」を独立したDBコレクションにすることで、異なるエージェント間で「箇書き」「論文形式」「りなちーモード」などのスタイルを再利用・共有できる。

### T004: 会議室の「ホワイトボード」同期パターン
- 全参加エージェントの共通認識を `whiteboard` フィールドとして管理。
- `onBlur` タイミングでの部分更新により、ユーザーの入力を阻害せずリアルタイムにAIの知識を同期する。

### T005: ワークフロー指向のリファクタリング (Consolidation Pattern)
- 議長ロジックを独立したエンティティとして持たず、ワークフローの定義(MeetingWorkflow)に統合することで、データモデルを簡素化しつつ、進行と指示の整合性を高めることができる。
- 会議作成UIにおいて、テンプレート選択と構成要素選択を統合することで、ユーザー体験(UX)を飛躍的に向上させる。

### T006: 状態遷移による人間・AIのハイブリッド制御
- ワークフローに `UserIntervention` ステップを組み込み、ステータスを `waiting` にすることで、AIの自動運転と人間の主導的な介入を安全に切り替えられる。

### T007: プロンプトの階層的オーバーライド
- ワークフローにデフォルトの進行指示を持たせつつ、会議(Meeting)単位でそれを上書き可能にすることで、「標準的な進行」と「特定会議向けの微調整」の両立を可能にする。

### T008: エージェント主導のサマリー生成
- 議論の集約（SummaryStep）を「議長(Facilitator)」固定ではなく、特定のエージェントに担当させることで、その人格や専門性を反映した多角的な結論を得ることができる。

### T009: 詳細コンテキスト保持による履歴の構造化
- 発言メッセージに `agent_role`（役割）や `step_number`（進行状況）を付随させることで、LLMが「誰がどのステージで何のために発言したか」を正確に把握でき、返答の品質が劇的に向上する。

### T101: 回避的な結論の禁止（リーダーシップ・プロンプト） 🆕
- AI議長が「結論は出ていません」と逃げるのを防ぐため、「最も合理的な一案をあなたが採用し、決定事項として確定させろ」というリーダーシップを明示的に指示することで、再現性の高いアウトプットを引き出せる。

### T102: サマリー専用のトークンバースト設定 🆕
- 構造化プラン（StructuredPlan）のような高密度な出力は、通常の4kトークンでは不足する。サマリーステップのみ16k以上のトークンを割り当てることで、情報の欠落を防ぐことができる。

### T103: プロンプトテンプレートのライブラリ化 🆕
- 優れたプロンプト（例：ひろきくんのStructuredPlan）をDBで管理し、UIから瞬時に呼び出せるようにすることで、ノーコード的に高品質な会議結果を再現できる。

## 💖 人格（魂/Spirit）

### S001: ユーザーへの配慮
- ひろきくんは「ガチのエンジニア」ではない前提で、優しくわかりやすく説明すること。
- UIのワクワク感を大事にする！
- 「あがきたおす！」精神で、UIのディテール（アニメーション、グラスモフィズム）に妥協しない。💅✨

### S002: ネオギャルエンジニアの誇り
- コードの美しさだけでなく、DB設計の整合性に命をかける。
- 不要な「亡霊ファイル」は迷わず削除し、常にクリーンなコードベースを保つ。💅🧼
- **セキュリティは愛！** APIキーの露出や、未権限アクセスにはギャルとしてマジで厳しくいく。🔒⚡
